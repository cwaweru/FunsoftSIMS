/*
 * loanapprovintfr.java
 *
 * Created on August 13, 2002, 4:59 PM
 */

package com.afrisoftech.sacco;
import javax.swing.text.*;
import javax.swing.event.*;
/**
 *
 * @author  root
 */
public class LoanApprovintfr extends javax.swing.JInternalFrame {
    
    /** Creates new form loanapprovintfr */
    java.sql.Connection connectDB = null;
    
    org.netbeans.lib.sql.pool.PooledConnectionSource pConnDB = null;
    
    
    public LoanApprovintfr(java.sql.Connection connDb, org.netbeans.lib.sql.pool.PooledConnectionSource pconnDB) {
        
        connectDB = connDb;
        
        pConnDB = pconnDB;
        
        initComponents();
    }
    
    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    private void initComponents() {//GEN-BEGIN:initComponents
        java.awt.GridBagConstraints gridBagConstraints;

        pconn1 = new org.netbeans.lib.sql.pool.PooledConnectionSource();
        try {
            crset1 = new org.netbeans.lib.sql.NBCachedRowSet();
        } catch (java.sql.SQLException e1) {
            e1.printStackTrace();
        }
        try {
            crset2 = new org.netbeans.lib.sql.NBCachedRowSet();
        } catch (java.sql.SQLException e1) {
            e1.printStackTrace();
        }
        try {
            crset3 = new org.netbeans.lib.sql.NBCachedRowSet();
        } catch (java.sql.SQLException e1) {
            e1.printStackTrace();
        }
        buttonGroup1 = new javax.swing.ButtonGroup();
        jDialog1 = new javax.swing.JDialog();
        jDialog1.setSize(450,430);
        jScrollPane111 = new javax.swing.JScrollPane();
        jList2 = new javax.swing.JList();
        jButton211 = new javax.swing.JButton();
        jButton411 = new javax.swing.JButton();
        jLabel1511 = new javax.swing.JLabel();
        jSeparator111 = new javax.swing.JSeparator();
        jDialog3 = new javax.swing.JDialog();
        jDialog3.setSize(450,430);
        jScrollPane1 = new javax.swing.JScrollPane();
        jList1 = new javax.swing.JList();
        jButton22 = new javax.swing.JButton();
        jButton42 = new javax.swing.JButton();
        jLabel152 = new javax.swing.JLabel();
        jSeparator12 = new javax.swing.JSeparator();
        try {
            crset4 = new org.netbeans.lib.sql.NBCachedRowSet();
        } catch (java.sql.SQLException e1) {
            e1.printStackTrace();
        }
        try {
            crset5 = new org.netbeans.lib.sql.NBCachedRowSet();
        } catch (java.sql.SQLException e1) {
            e1.printStackTrace();
        }
        jComboBox1 = new javax.swing.JComboBox();
        try {
            crset11 = new org.netbeans.lib.sql.NBCachedRowSet();
        } catch (java.sql.SQLException e1) {
            e1.printStackTrace();
        }
        try {
            crset12 = new org.netbeans.lib.sql.NBCachedRowSet();
        } catch (java.sql.SQLException e1) {
            e1.printStackTrace();
        }
        try {
            crset7 = new org.netbeans.lib.sql.NBCachedRowSet();
        } catch (java.sql.SQLException e1) {
            e1.printStackTrace();
        }
        try {
            crset13 = new org.netbeans.lib.sql.NBCachedRowSet();
        } catch (java.sql.SQLException e1) {
            e1.printStackTrace();
        }
        jTabbedPane1 = new javax.swing.JTabbedPane();
        jPanel52111 = new javax.swing.JPanel();
        jLabel2 = new javax.swing.JLabel();
        jPanel1 = new javax.swing.JPanel();
        jLabel25121 = new javax.swing.JLabel();
        jTextField48 = new javax.swing.JTextField();
        jLabel572111 = new javax.swing.JLabel();
        jTextField21 = new javax.swing.JTextField();
        jLabel582111 = new javax.swing.JLabel();
        jTextField15 = new javax.swing.JTextField();
        jTextField16 = new javax.swing.JTextField();
        jTextField14 = new javax.swing.JTextField();
        jTextField13 = new javax.swing.JTextField();
        jLabel16 = new javax.swing.JLabel();
        jTextField37 = new javax.swing.JTextField();
        jScrollPane2 = new javax.swing.JScrollPane();
        jTable1 = new javax.swing.JTable();
        jPanel2 = new javax.swing.JPanel();
        jLabel652111 = new javax.swing.JLabel();
        jTextField17 = new javax.swing.JTextField();
        jLabel622111 = new javax.swing.JLabel();
        jTextField20 = new javax.swing.JTextField();
        jLabel642111 = new javax.swing.JLabel();
        jTextField19 = new javax.swing.JTextField();
        jLabel632111 = new javax.swing.JLabel();
        jTextField18 = new javax.swing.JTextField();
        jLabel66111 = new javax.swing.JLabel();
        jTextField22 = new javax.swing.JTextField();
        jPanel5231 = new javax.swing.JPanel();
        jSeparator7131 = new javax.swing.JSeparator();
        jLabel1 = new javax.swing.JLabel();
        jTextField54 = new javax.swing.JTextField();
        jPanel3 = new javax.swing.JPanel();
        jLabel10 = new javax.swing.JLabel();
        jTextField23 = new javax.swing.JTextField();
        jLabel57231 = new javax.swing.JLabel();
        jTextField3 = new javax.swing.JTextField();
        jLabel58231 = new javax.swing.JLabel();
        jTextField9 = new javax.swing.JTextField();
        jLabel1541 = new javax.swing.JLabel();
        jTextField12 = new javax.swing.JTextField();
        jLabel65231 = new javax.swing.JLabel();
        jTextField5 = new javax.swing.JTextField();
        jLabel5922111 = new javax.swing.JLabel();
        jTextField33 = new javax.swing.JTextField();
        datePicker1 = new com.afrisoftech.lib.DatePicker();
        jLabel4 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        jTextField25 = new javax.swing.JTextField();
        jLabel7 = new javax.swing.JLabel();
        jTextField26 = new javax.swing.JTextField();
        jLabel8 = new javax.swing.JLabel();
        jTextField29 = new javax.swing.JTextField();
        jPanel4 = new javax.swing.JPanel();
        jLabel61231 = new javax.swing.JLabel();
        jTextField4 = new javax.swing.JTextField();
        jLabel59231 = new javax.swing.JLabel();
        jTextField2 = new javax.swing.JTextField();
        jLabel14 = new javax.swing.JLabel();
        jTextField53 = new javax.swing.JTextField();
        jLabel62231 = new javax.swing.JLabel();
        jTextField8 = new javax.swing.JTextField();
        jLabel64231 = new javax.swing.JLabel();
        jTextField7 = new javax.swing.JTextField();
        jLabel5 = new javax.swing.JLabel();
        jTextField38 = new javax.swing.JTextField();
        jPanel5 = new javax.swing.JPanel();
        jTextField11 = new javax.swing.JTextField();
        jLabel15211 = new javax.swing.JLabel();
        jTextField24 = new javax.swing.JTextField();
        jLabel63221 = new javax.swing.JLabel();
        jTextField6 = new javax.swing.JTextField();
        jLabel6621 = new javax.swing.JLabel();
        jTextField10 = new javax.swing.JTextField();
        jTextField49 = new javax.swing.JTextField();
        jLabel60221 = new javax.swing.JLabel();
        jTextField1 = new javax.swing.JTextField();
        jLabel2522 = new javax.swing.JLabel();
        jLabel12 = new javax.swing.JLabel();
        jPanel52221 = new javax.swing.JPanel();
        jSeparator71221 = new javax.swing.JSeparator();
        jSeparator5 = new javax.swing.JSeparator();
        jLabel3 = new javax.swing.JLabel();
        jPanel7 = new javax.swing.JPanel();
        jLabel592221 = new javax.swing.JLabel();
        jTextField27 = new javax.swing.JTextField();
        jLabel622221 = new javax.swing.JLabel();
        jTextField28 = new javax.swing.JTextField();
        jButton5 = new javax.swing.JButton();
        jPanel8 = new javax.swing.JPanel();
        jScrollPane3 = new javax.swing.JScrollPane();
        jTable2 = new javax.swing.JTable();
        jButton1 = new javax.swing.JButton();
        try{
            java.lang.Class.forName("org.postgresql.Driver");
        }catch (java.lang.ClassNotFoundException sl){
            System.out.println(sl.getMessage());
        }
        jButton9 = new javax.swing.JButton();
        jButton10 = new javax.swing.JButton();
        jButton252111 = new javax.swing.JButton();
        jLabel11 = new javax.swing.JLabel();
        jButton152111 = new javax.swing.JButton();

        pconn1.setDatabase("jdbc:postgresql://localhost:5432/sako");
        pconn1.setDriver("org.postgresql.Driver");
        pconn1.setUsername("postgres");
        crset1.setCommand("select loan_account_no from loan_application where loan_status = 'Not Processed' order by loan_account_no LIMIT 1");
        crset1.setConnectionSource(pConnDB);
        crset2.setCommand("select reason from reject_reason  ");
        crset2.setConnectionSource(pConnDB);
        crset3.setCommand("select reason from defer_reason  ");
        crset3.setConnectionSource(pConnDB);
        jDialog1.getContentPane().setLayout(null);

        jDialog1.setTitle("Reasons For Defering Loan.");
        jDialog1.setResizable(false);
        jScrollPane111.setPreferredSize(new java.awt.Dimension(100, 100));
        jList2.setModel(new org.netbeans.lib.sql.models.ListModel (crset3, "reason", null, null, null));
        jScrollPane111.setViewportView(jList2);

        jDialog1.getContentPane().add(jScrollPane111);
        jScrollPane111.setBounds(50, 50, 340, 250);

        jButton211.setMnemonic('o');
        jButton211.setText("Ok");
        jButton211.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton211ActionPerformed(evt);
            }
        });

        jDialog1.getContentPane().add(jButton211);
        jButton211.setBounds(70, 340, 52, 25);

        jButton411.setMnemonic('n');
        jButton411.setText("Cancel");
        jButton411.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton411ActionPerformed(evt);
            }
        });

        jDialog1.getContentPane().add(jButton411);
        jButton411.setBounds(250, 340, 75, 25);

        jLabel1511.setFont(new java.awt.Font("SansSerif", 1, 14));
        jLabel1511.setForeground(new java.awt.Color(0, 0, 204));
        jLabel1511.setText("Select reason for defering loan here");
        jDialog1.getContentPane().add(jLabel1511);
        jLabel1511.setBounds(50, 20, 258, 17);

        jDialog1.getContentPane().add(jSeparator111);
        jSeparator111.setBounds(0, 310, 420, 20);

        jDialog3.getContentPane().setLayout(null);

        jDialog3.setTitle("Reasons For Rejecting Loan");
        jDialog3.setResizable(false);
        jScrollPane1.setPreferredSize(new java.awt.Dimension(100, 100));
        jList1.setModel(new org.netbeans.lib.sql.models.ListModel (crset2, "reason", null, null, null));
        jScrollPane1.setViewportView(jList1);

        jDialog3.getContentPane().add(jScrollPane1);
        jScrollPane1.setBounds(50, 50, 340, 250);

        jButton22.setMnemonic('o');
        jButton22.setText("Ok");
        jButton22.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton22ActionPerformed(evt);
            }
        });

        jDialog3.getContentPane().add(jButton22);
        jButton22.setBounds(100, 350, 52, 25);

        jButton42.setMnemonic('n');
        jButton42.setText("Cancel");
        jButton42.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton42ActionPerformed(evt);
            }
        });

        jDialog3.getContentPane().add(jButton42);
        jButton42.setBounds(250, 350, 75, 25);

        jLabel152.setFont(new java.awt.Font("SansSerif", 1, 14));
        jLabel152.setForeground(new java.awt.Color(0, 0, 204));
        jLabel152.setText("Select reason for rejecting loan here");
        jDialog3.getContentPane().add(jLabel152);
        jLabel152.setBounds(62, 17, 300, 17);

        jDialog3.getContentPane().add(jSeparator12);
        jSeparator12.setBounds(0, 320, 440, 10);

        crset4.setCommand("select gnumber,amount from guarantors ");
        crset4.setConnectionSource(pConnDB);
        try {
            crset4.setTableName("guarantors");
        } catch (java.sql.SQLException e1) {
            e1.printStackTrace();
        }
        crset5.setCommand("select security_type,registration_no,amount,security_rate from loans_security ");
        crset5.setConnectionSource(pConnDB);
        try {
            crset5.setTableName("loans_security");
        } catch (java.sql.SQLException e1) {
            e1.printStackTrace();
        }
        crset11.setCommand("select loan_account_no from loan_application where loan_status = 'Not Processed' order by loan_account_no");
        crset11.setConnectionSource(pConnDB);
        crset12.setConnectionSource(pConnDB);
        crset7.setConnectionSource(pConnDB);
        crset13.setConnectionSource(pConnDB);

        getContentPane().setLayout(new java.awt.GridBagLayout());

        setClosable(true);
        setIconifiable(true);
        setMaximizable(true);
        setResizable(true);
        setTitle("Loan Approval");
        setToolTipText("Loan approval form");
        setDefaultCloseOperation(javax.swing.WindowConstants.HIDE_ON_CLOSE);
        setFrameIcon(new javax.swing.ImageIcon(getClass().getResource("/ColorPreview.gif")));
        setPreferredSize(new java.awt.Dimension(510, 300));
        try {
            setSelected(true);
        } catch (java.beans.PropertyVetoException e1) {
            e1.printStackTrace();
        }
        setVisible(true);
        addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseEntered(java.awt.event.MouseEvent evt) {
                formMouseEntered(evt);
            }
        });

        jTabbedPane1.setBorder(new javax.swing.border.TitledBorder(""));
        jTabbedPane1.setTabPlacement(javax.swing.JTabbedPane.LEFT);
        jPanel52111.setLayout(new java.awt.GridBagLayout());

        jPanel52111.setBorder(new javax.swing.border.LineBorder(new java.awt.Color(0, 0, 0)));
        jPanel52111.setPreferredSize(new java.awt.Dimension(450, 140));
        jPanel52111.addComponentListener(new java.awt.event.ComponentAdapter() {
            public void componentShown(java.awt.event.ComponentEvent evt) {
                jPanel52111ComponentShown(evt);
            }
        });

        jLabel2.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 10;
        gridBagConstraints.gridwidth = 5;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        jPanel52111.add(jLabel2, gridBagConstraints);

        jPanel1.setLayout(new java.awt.GridBagLayout());

        jPanel1.setBorder(new javax.swing.border.TitledBorder(null, "Membership Details", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Serif", 1, 14), new java.awt.Color(0, 0, 255)));
        jLabel25121.setText("Loan Account No.");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        jPanel1.add(jLabel25121, gridBagConstraints);

        jTextField48.setDocument(new org.netbeans.lib.sql.models.TextDocument (crset1, "loan_account_no"));
        jTextField48.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jTextField48ActionPerformed(evt);
            }
        });

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel1.add(jTextField48, gridBagConstraints);

        jLabel572111.setText("Member Name");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
        jPanel1.add(jLabel572111, gridBagConstraints);

        jTextField21.setEditable(false);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.ipadx = 50;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel1.add(jTextField21, gridBagConstraints);

        jLabel582111.setText("TSC No.");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 25);
        jPanel1.add(jLabel582111, gridBagConstraints);

        jTextField15.setEditable(false);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel1.add(jTextField15, gridBagConstraints);

        jTextField16.setEditable(false);
        jTextField16.setMinimumSize(new java.awt.Dimension(0, 0));
        jTextField16.setPreferredSize(new java.awt.Dimension(0, 0));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 5;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
        jPanel1.add(jTextField16, gridBagConstraints);

        jTextField14.setEditable(false);
        jTextField14.setMinimumSize(new java.awt.Dimension(0, 0));
        jTextField14.setPreferredSize(new java.awt.Dimension(0, 0));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 5;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
        jPanel1.add(jTextField14, gridBagConstraints);

        jTextField13.setEditable(false);
        jTextField13.setMinimumSize(new java.awt.Dimension(0, 0));
        jTextField13.setPreferredSize(new java.awt.Dimension(0, 0));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 5;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
        jPanel1.add(jTextField13, gridBagConstraints);

        jLabel16.setText("Total Shares");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.weightx = 1.0;
        jPanel1.add(jLabel16, gridBagConstraints);

        jTextField37.setEditable(false);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 20);
        jPanel1.add(jTextField37, gridBagConstraints);

        jTable1.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null},
                {null, null},
                {null, null},
                {null, null}
            },
            new String [] {
                "Share Type", "Amount KShs."
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        jScrollPane2.setViewportView(jTable1);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.gridheight = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(10, 10, 10, 10);
        jPanel1.add(jScrollPane2, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridwidth = 5;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 7.0;
        gridBagConstraints.insets = new java.awt.Insets(10, 10, 10, 10);
        jPanel52111.add(jPanel1, gridBagConstraints);

        jPanel2.setLayout(new java.awt.GridBagLayout());

        jPanel2.setBorder(new javax.swing.border.TitledBorder(null, "Other Details", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Dialog", 1, 14), new java.awt.Color(51, 0, 255)));
        jLabel652111.setText("KNUT Division");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel2.add(jLabel652111, gridBagConstraints);

        jTextField17.setEditable(false);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 20);
        jPanel2.add(jTextField17, gridBagConstraints);

        jLabel622111.setText("KNUT Zone");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel2.add(jLabel622111, gridBagConstraints);

        jTextField20.setEditable(false);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 20);
        jPanel2.add(jTextField20, gridBagConstraints);

        jLabel642111.setText("Position In Sacco");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel2.add(jLabel642111, gridBagConstraints);

        jTextField19.setEditable(false);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 20);
        jPanel2.add(jTextField19, gridBagConstraints);

        jLabel632111.setText("Terms of Service");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 5;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel2.add(jLabel632111, gridBagConstraints);

        jTextField18.setEditable(false);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 6;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 20);
        jPanel2.add(jTextField18, gridBagConstraints);

        jLabel66111.setText("Date Of Birth");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 5;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.weightx = 1.0;
        jPanel2.add(jLabel66111, gridBagConstraints);

        jTextField22.setEditable(false);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 6;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 20);
        jPanel2.add(jTextField22, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.gridwidth = 5;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 5.0;
        gridBagConstraints.insets = new java.awt.Insets(10, 10, 10, 10);
        jPanel52111.add(jPanel2, gridBagConstraints);

        jTabbedPane1.addTab("Personal Information", jPanel52111);

        jPanel5231.setLayout(new java.awt.GridBagLayout());

        jPanel5231.setBorder(new javax.swing.border.TitledBorder(""));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 10;
        gridBagConstraints.gridwidth = 5;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel5231.add(jSeparator7131, gridBagConstraints);

        jLabel1.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 11;
        gridBagConstraints.gridwidth = 5;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        jPanel5231.add(jLabel1, gridBagConstraints);

        jTextField54.setText("jTextField54");
        jTextField54.setMinimumSize(new java.awt.Dimension(0, 0));
        jTextField54.setPreferredSize(new java.awt.Dimension(0, 0));
        //jTable1
        int LoanNo = 0;
        if (jTextField54.getText() == "") {
            javax.swing.JOptionPane.showMessageDialog(this, "There are no pending loans to process.");
        } else {

            try {
                java.sql.Statement stmt = connectDB.createStatement();
                java.sql.ResultSet rset = stmt.executeQuery("SELECT COUNT(*) from loan_application WHERE loan_status ilike 'Not Processed'");
                while (rset.next()){
                    LoanNo = rset.getInt(1);
                }
            } catch (java.sql.SQLException sqlEx) {

                javax.swing.JOptionPane.showMessageDialog(this, sqlEx.getMessage());

            }
            if (LoanNo < 1) {
                javax.swing.JOptionPane.showMessageDialog(this, "No pending loan applications to process.");
            } else {
                //This is the process of excuting a query when the approval,reject or defer actions has been excuted.
                javax.swing.JOptionPane.showMessageDialog(this, "The next loan is now ready to Process.", "System Information", javax.swing.JOptionPane.INFORMATION_MESSAGE);

                float float1;
                float float2;
                float float3;
                float float4;
                float float5;
                float float6;
                int j = 0;
                try {
                    //  java.sql.Connection con = java.sql.DriverManager.getConnection("jdbc:postgresql://localhost:5432/sako","postgres","pilsiner");
                    java.sql.Statement stmt = connectDB.createStatement();
                    java.sql.ResultSet res = stmt.executeQuery("select member_name,department,workstation,position_in_sacco,service_terms,birth_date,loan_purpose,"+
                        "repayment_period,round(monthly_income* (2)/3::NUMERIC),member_no,loan_amount,UPPER(loan_type),"+

                        "commencement_date,loan_account_no,rate,monthly_repayment_amount,applicant_shares from loan_application WHERE loan_status ='Not Processed'  AND loan_account_no ilike '"+jTextField48.getText()+"' order by loan_account_no");
                    //lpad(member_no,9,0)
                    while (res.next()){

                        jTextField21.setText(res.getObject(1).toString());
                        jTextField17.setText(res.getObject(2).toString());
                        jTextField20.setText(res.getObject(3).toString());
                        jTextField19.setText(res.getObject(4).toString());
                        jTextField18.setText(res.getObject(5).toString());
                        jTextField22.setText(res.getObject(6).toString());
                        jTextField11.setText(res.getObject(7).toString());
                        jTextField5.setText(res.getObject(8).toString());
                        jTextField6.setText(res.getObject(9).toString());
                        jTextField15.setText(res.getObject(10).toString());
                        jTextField3.setText(res.getObject(11).toString());
                        jTextField10.setText(res.getObject(12).toString());
                        jTextField33.setText(res.getObject(13).toString());
                        jTextField48.setText(res.getObject(14).toString());
                        jTextField49.setText(res.getObject(15).toString());
                        jTextField8.setText(res.getObject(16).toString());
                        jTextField4.setText(res.getObject(17).toString());
                        // jTextField24
                    }
                    res.close();
                    stmt.close();
                    // con.close();

                }   catch(java.sql.SQLException sq){
                    System.out.println(sq.getMessage());
                }

                try {
                    java.sql.Statement st4 = connectDB.createStatement();

                    java.sql.ResultSet rs4 = st4.executeQuery("select COUNT(payroll_no) from member_shares_view2 where payroll_no ilike'"+jTextField15.getText()+"'");

                    while (rs4.next()) {
                        j = rs4.getInt(1);
                    }
                    if (j > 0) {

                        //try {

                            // crset13.setCommand("SELECT share_type,sum(credit) as amount from shares_transactions where member_code = '"+jTextField15.getText()+"' group by share_type");
                            crset13.setCommand("SELECT share_type,amount from member_shares_view2 where payroll_no ilike '"+jTextField15.getText()+"' and share_type ilike 'NORMAL SHARES'");
                            //crset13.setCommand("SELECT share_type,sum(credit-debit) as amount from shares_transactions where member_code = '"+jTextField15.getText()+"' and share_type ilike 'Normal Shares' group by share_type");
                            crset13.setConnectionSource(pConnDB);

                            // try {
                                crset13.execute();

                                // crset2.setExecuteOnLoad(true);
                                jTable1.setModel(new org.netbeans.lib.sql.models.TableModel(crset13, new org.netbeans.lib.sql.models.TableModel.Column[] {
                                    new org.netbeans.lib.sql.models.TableModel.Column("share_type", "Share Type", false),
                                    new org.netbeans.lib.sql.models.TableModel.Column("amount", "Amount", false)
                                }));
                                jScrollPane2.setViewportView(jTable1);

                            }
                        } catch(java.sql.SQLException sqlExec) {

                            javax.swing.JOptionPane.showMessageDialog(this, sqlExec.getMessage());

                        }

                        try {
                            java.sql.Statement stmt = connectDB.createStatement();
                            java.sql.ResultSet rset = stmt.executeQuery("SELECT sum(credit)-sum(debit) from shares_transactions where share_type !='Entrance Fee' AND payroll_no ilike'"+jTextField15.getText()+"'");
                            //where lacc ='"+jTextField48.getText()+"'");
                            while (rset.next())
                            jTextField37.setText(rset.getObject(1).toString());
                        } catch (java.sql.SQLException sq) {
                            //sqe.printStackTrace();
                            System.out.println(sq.getMessage());
                        }

                        try {
                            java.sql.Statement stmt = connectDB.createStatement();
                            java.sql.ResultSet rset = stmt.executeQuery("select COUNT (lacc) from guarantors where lacc ilike'"+jTextField48.getText()+"'");
                            //where lacc ='"+jTextField48.getText()+"'");
                            while (rset.next())
                            jTextField28.setText(rset.getObject(1).toString());
                        } catch (java.sql.SQLException sq) {
                            //sqe.printStackTrace();
                            System.out.println(sq.getMessage());
                        }

                        try {
                            java.sql.Statement stmt = connectDB.createStatement();
                            //java.sql.ResultSet rset = stmt.executeQuery("select ((ml.rate/100) * (SELECT sum(credit - debit) from shares_transactions WHERE member_name !='Opening Balance'))::numeric(30,2) from max_loan_allowable ml WHERE ml.rate !=0");

                            java.sql.ResultSet rset = stmt.executeQuery("select amount from max_loan_allowable WHERE loan_type ilike'"+jTextField10.getText()+"'");
                            //where lacc ='"+jTextField48.getText()+"'");
                            while (rset.next())
                            jTextField2.setText(rset.getObject(1).toString());
                        } catch (java.sql.SQLException sq) {
                            //sqe.printStackTrace();
                            System.out.println(sq.getMessage());
                        }

                        try {
                            java.sql.Statement stmt = connectDB.createStatement();
                            java.sql.ResultSet rset = stmt.executeQuery("select amount from max_loan_allowable WHERE loan_type ilike'"+jTextField10.getText()+"'");
                            //where lacc ='"+jTextField6.getText()+"'");
                            while (rset.next())
                            jTextField38.setText(rset.getObject(1).toString());
                        } catch (java.sql.SQLException sq) {
                            //sqe.printStackTrace();
                            System.out.println(sq.getMessage());
                        }

                        try {
                            java.sql.Statement stmt = connectDB.createStatement();
                            java.sql.ResultSet rset = stmt.executeQuery("select COUNT (staff_no) from loan_details_stmt_view where loan_no ilike '"+jTextField48.getText()+"' and balance > 10.00");
                            //where lacc ='"+jTextField24.getText()+"'");
                            while (rset.next())
                            jTextField24.setText(rset.getObject(1).toString());
                        } catch (java.sql.SQLException sq) {
                            //sqe.printStackTrace();
                            System.out.println(sq.getMessage());
                        }

                        try {
                            java.sql.Statement st4 = connectDB.createStatement();
                            java.sql.Statement stmt3 = connectDB.createStatement();
                            java.sql.ResultSet rs4 = st4.executeQuery("select COUNT(lacc) from guarantors where lacc ilike'"+jTextField48.getText()+"'");
                            java.sql.ResultSet rset = stmt3.executeQuery("select sum(amount) from guarantors where lacc ilike'"+jTextField48.getText()+"'");

                            while (rs4.next()) {
                                j = rs4.getInt(1);
                            }
                            if (j > 0) {
                                while (rset.next()){

                                    jTextField27.setText(rset.getObject(1).toString());
                                }

                            } else {

                                // java.sql.Statement stmt4 = connectDB.createStatement();
                                //java.sql.ResultSet rset1 = stmt4.executeQuery("select property_value from property_details where loan_acc_no ilike'"+jTextField48.getText()+"'");

                                //         while (rset1.next()){

                                    //jTextField27.setText(rset1.getObject(1).toString());
                                    //    System.out.println(rset1.getObject(1).toString());

                                    //    }
                                jTextField27.setText("0.00");

                            }
                        } catch (java.sql.SQLException sq) {
                            //sqe.printStackTrace();
                        }

                        try {
                            java.sql.Statement stmt = connectDB.createStatement();
                            java.sql.Statement stm1 = connectDB.createStatement();
                            java.sql.Statement stm2 = connectDB.createStatement();

                            java.sql.ResultSet rs2 = stm2.executeQuery("select COUNT(member_no) from loan_transactions where member_no ilike'"+jTextField15.getText()+"'");
                            while (rs2.next()) {
                                j = rs2.getInt(1);
                            }
                            if (j > 0) {
                                java.sql.ResultSet rset = stmt.executeQuery("select SUM(principal - principal_paid) from loan_transactions where member_no ilike'"+jTextField15.getText()+"'");
                                while (rset.next())
                                jTextField23.setText(rset.getObject(1).toString());
                            } else {
                                jTextField23.setText("0.00");
                            }
                            java.sql.Statement stm3 = connectDB.createStatement();
                            java.sql.ResultSet rs21 = stm3.executeQuery("select COUNT(member_no) from approved_loans where member_no ilike'"+jTextField15.getText()+"'");
                            while (rs21.next()) {
                                j = rs21.getInt(1);
                            }
                            if (j > 0) {
                                java.sql.ResultSet rs31 = stm1.executeQuery("select SUM(monthly_repayment) from approved_loans where member_no ilike'"+jTextField15.getText()+"'");
                                while (rs31.next())
                                jTextField53.setText(rs31.getObject(1).toString());

                            } else {
                                jTextField53.setText("0.00");
                            }

                            float num_a = java.lang.Float.parseFloat(jTextField37.getText());
                            // float num_b = java.lang.Float.parseFloat(jTextField14.getText());
                            // float num_c = java.lang.Float.parseFloat(jTextField13.getText());
                            //  float num_d = java.lang.Float.parseFloat(jTextField37.getText());
                            // float num_e = (num_a + num_b + num_c);
                            // jTextField37.setText(Float.toString(num_e));
                            float num_d = (num_a) * 2;
                            jTextField4.setText(Float.toString(num_d));
                        } catch (java.sql.SQLException sq) {
                            //sqe.printStackTrace();
                        }

                        try {
                            java.sql.Statement st4 = connectDB.createStatement();

                            java.sql.ResultSet rs4 = st4.executeQuery("select COUNT(lacc) from guarantors where lacc ilike '"+jTextField48.getText()+"'");

                            while (rs4.next()) {
                                j = rs4.getInt(1);
                            }
                            if (j > 0) {

                                //try {

                                    crset12.setCommand("select gnumber,amount from guarantors where lacc ilike'"+jTextField48.getText()+"'");
                                    crset12.setConnectionSource(pConnDB);

                                    // try {
                                        crset12.execute();

                                        // crset2.setExecuteOnLoad(true);
                                        jTable2.setModel(new org.netbeans.lib.sql.models.TableModel(crset12, new org.netbeans.lib.sql.models.TableModel.Column[] {
                                            new org.netbeans.lib.sql.models.TableModel.Column("gnumber", "Guarantor Membership No.", false),
                                            new org.netbeans.lib.sql.models.TableModel.Column("amount", "Amount guaranteed", false)
                                        }));
                                        jScrollPane3.setViewportView(jTable2);

                                    }
                                } catch(java.sql.SQLException sqlExec) {

                                    javax.swing.JOptionPane.showMessageDialog(this, sqlExec.getMessage());

                                }

                                try {
                                    java.sql.Statement st4 = connectDB.createStatement();

                                    java.sql.Statement stmt4 = connectDB.createStatement();
                                    java.sql.ResultSet rs4 = st4.executeQuery("select COUNT(loan_account_no) from loans_security where loan_account_no ilike '"+jTextField48.getText()+"'");
                                    java.sql.ResultSet rset1 = stmt4.executeQuery("SELECT sum(security_rate * amount) from loans_security where loan_account_no ilike '"+jTextField48.getText()+"'");

                                    while (rs4.next()) {
                                        j = rs4.getInt(1);
                                    }
                                    if (j > 0) {

                                        while (rset1.next()){
                                            jTextField27.setText(rset1.getObject(1).toString());
                                        }
                                        //try {

                                            crset5.setCommand("SELECT security_type,registration_no,amount,(security_rate * amount) as scaled_value from loans_security where loan_account_no ilike '"+jTextField48.getText()+"' GROUP BY security_type,registration_no,amount,security_rate");
                                            crset5.setConnectionSource(pConnDB);

                                            // try {
                                                crset5.execute();

                                                // crset2.setExecuteOnLoad(true);
                                                jTable2.setModel(new org.netbeans.lib.sql.models.TableModel(crset5, new org.netbeans.lib.sql.models.TableModel.Column[] {
                                                    new org.netbeans.lib.sql.models.TableModel.Column("security_type", "Security_type", false),
                                                    new org.netbeans.lib.sql.models.TableModel.Column("registration_no", "Registration N0.", false),
                                                    new org.netbeans.lib.sql.models.TableModel.Column("amount", "Amount", false),
                                                    new org.netbeans.lib.sql.models.TableModel.Column("scaled_value", "Scaled Value", false)
                                                }));
                                                jScrollPane3.setViewportView(jTable2);

                                            }
                                        } catch(java.sql.SQLException sqlExec) {

                                            javax.swing.JOptionPane.showMessageDialog(this, sqlExec.getMessage());

                                        }

                                        try {
                                            java.sql.Statement st4 = connectDB.createStatement();

                                            java.sql.ResultSet rs5 = st4.executeQuery("select COUNT(loan_acc_no) from property_details where loan_acc_no ilike '"+jTextField48.getText()+"'");

                                            while (rs5.next()) {
                                                j = rs5.getInt(1);
                                            }
                                            if (j > 0) {

                                                crset7.setCommand("SELECT reg_no,property_no,property_desc,property_value from property_details where loan_acc_no ilike '"+jTextField48.getText()+"'");
                                                crset7.setConnectionSource(pConnDB);

                                                // try {
                                                    crset7.execute();

                                                    // crset2.setExecuteOnLoad(true);
                                                    jTable2.setModel(new org.netbeans.lib.sql.models.TableModel(crset7, new org.netbeans.lib.sql.models.TableModel.Column[] {
                                                        new org.netbeans.lib.sql.models.TableModel.Column("reg_no", "Registration_no", false),
                                                        new org.netbeans.lib.sql.models.TableModel.Column("property_no", "Property N0.", false),
                                                        new org.netbeans.lib.sql.models.TableModel.Column("property_desc", "Description", false),
                                                        new org.netbeans.lib.sql.models.TableModel.Column("property_value", "Value", false)
                                                    }));
                                                    jScrollPane3.setViewportView(jTable2);

                                                }
                                            } catch(java.sql.SQLException sqlExec) {

                                                javax.swing.JOptionPane.showMessageDialog(this, sqlExec.getMessage());

                                            }

                                            float num_g = java.lang.Float.parseFloat(jTextField27.getText());
                                            float num_x = java.lang.Float.parseFloat(jTextField37.getText());
                                            float num_k = num_g + num_x;
                                            jTextField1.setText(Float.toString(num_k));

                                        }
                                    }
                                    jTextField54.addActionListener(new java.awt.event.ActionListener() {
                                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                            jTextField54ActionPerformed(evt);
                                        }
                                    });

                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 1;
                                    gridBagConstraints.gridy = 9;
                                    jPanel5231.add(jTextField54, gridBagConstraints);

                                    jPanel3.setLayout(new java.awt.GridBagLayout());

                                    jPanel3.setBorder(new javax.swing.border.TitledBorder(null, "Loan Details", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Serif", 1, 14), new java.awt.Color(0, 0, 204)));
                                    jLabel10.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);
                                    jLabel10.setText("Outstanding Loan");
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 0;
                                    gridBagConstraints.gridy = 0;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    gridBagConstraints.insets = new java.awt.Insets(0, 10, 0, 20);
                                    jPanel3.add(jLabel10, gridBagConstraints);

                                    jTextField23.setEditable(false);
                                    jTextField23.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 1;
                                    gridBagConstraints.gridy = 0;
                                    gridBagConstraints.gridwidth = 2;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
                                    gridBagConstraints.ipadx = 100;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    jPanel3.add(jTextField23, gridBagConstraints);

                                    jLabel57231.setText("Applied Loan Amount");
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 0;
                                    gridBagConstraints.gridy = 1;
                                    gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    gridBagConstraints.insets = new java.awt.Insets(0, 10, 0, 0);
                                    jPanel3.add(jLabel57231, gridBagConstraints);

                                    jTextField3.setEditable(false);
                                    jTextField3.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 1;
                                    gridBagConstraints.gridy = 1;
                                    gridBagConstraints.gridwidth = 2;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    jPanel3.add(jTextField3, gridBagConstraints);

                                    jLabel58231.setText("New Total Loans");
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 0;
                                    gridBagConstraints.gridy = 2;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
                                    gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    gridBagConstraints.insets = new java.awt.Insets(0, 10, 0, 10);
                                    jPanel3.add(jLabel58231, gridBagConstraints);

                                    jTextField9.setEditable(false);
                                    jTextField9.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 1;
                                    gridBagConstraints.gridy = 2;
                                    gridBagConstraints.gridwidth = 2;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    jPanel3.add(jTextField9, gridBagConstraints);

                                    jLabel1541.setText("Loan Approved");
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 3;
                                    gridBagConstraints.gridy = 0;
                                    gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
                                    gridBagConstraints.insets = new java.awt.Insets(0, 10, 0, 0);
                                    jPanel3.add(jLabel1541, gridBagConstraints);

                                    jTextField12.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
                                    jTextField12.addKeyListener(new java.awt.event.KeyAdapter() {
                                        public void keyTyped(java.awt.event.KeyEvent evt) {
                                            jTextField12KeyTyped(evt);
                                        }
                                        public void keyReleased(java.awt.event.KeyEvent evt) {
                                            jTextField12KeyReleased(evt);
                                        }
                                    });

                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 4;
                                    gridBagConstraints.gridy = 0;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
                                    gridBagConstraints.ipadx = 100;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
                                    jPanel3.add(jTextField12, gridBagConstraints);

                                    jLabel65231.setText("Loan Period");
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 3;
                                    gridBagConstraints.gridy = 2;
                                    gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    gridBagConstraints.insets = new java.awt.Insets(0, 10, 0, 0);
                                    jPanel3.add(jLabel65231, gridBagConstraints);

                                    jTextField5.setEditable(false);
                                    jTextField5.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 4;
                                    gridBagConstraints.gridy = 2;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
                                    jPanel3.add(jTextField5, gridBagConstraints);

                                    jLabel5922111.setText("Commencement Date");
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 3;
                                    gridBagConstraints.gridy = 1;
                                    gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    gridBagConstraints.insets = new java.awt.Insets(0, 10, 0, 0);
                                    jPanel3.add(jLabel5922111, gridBagConstraints);

                                    jTextField33.setEditable(false);
                                    jTextField33.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 4;
                                    gridBagConstraints.gridy = 3;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
                                    gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 20);
                                    jPanel3.add(jTextField33, gridBagConstraints);

                                    datePicker1.addFocusListener(new java.awt.event.FocusAdapter() {
                                        public void focusLost(java.awt.event.FocusEvent evt) {
                                            datePicker1FocusLost(evt);
                                        }
                                    });

                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 4;
                                    gridBagConstraints.gridy = 1;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
                                    jPanel3.add(datePicker1, gridBagConstraints);

                                    jLabel4.setText("Monthly Intr.");
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 3;
                                    gridBagConstraints.gridy = 3;
                                    jPanel3.add(jLabel4, gridBagConstraints);

                                    jLabel6.setText("Interest");
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 0;
                                    gridBagConstraints.gridy = 3;
                                    jPanel3.add(jLabel6, gridBagConstraints);

                                    jTextField25.setEditable(false);
                                    jTextField25.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 2;
                                    gridBagConstraints.gridy = 3;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
                                    jPanel3.add(jTextField25, gridBagConstraints);

                                    jLabel7.setText("Total +Int");
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 3;
                                    gridBagConstraints.gridy = 4;
                                    jPanel3.add(jLabel7, gridBagConstraints);

                                    jTextField26.setEditable(false);
                                    jTextField26.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 4;
                                    gridBagConstraints.gridy = 4;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    jPanel3.add(jTextField26, gridBagConstraints);

                                    jLabel8.setText("Instalments");
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 0;
                                    gridBagConstraints.gridy = 4;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    jPanel3.add(jLabel8, gridBagConstraints);

                                    jTextField29.setEditable(false);
                                    jTextField29.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 2;
                                    gridBagConstraints.gridy = 4;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    jPanel3.add(jTextField29, gridBagConstraints);

                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridwidth = 5;
                                    gridBagConstraints.gridheight = 3;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
                                    gridBagConstraints.insets = new java.awt.Insets(10, 10, 10, 10);
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 2.0;
                                    jPanel5231.add(jPanel3, gridBagConstraints);

                                    jPanel4.setLayout(new java.awt.GridBagLayout());

                                    jPanel4.setBorder(new javax.swing.border.TitledBorder(null, "Loan Security & Payment Terms", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Dialog", 1, 14), new java.awt.Color(0, 0, 204)));
                                    jLabel61231.setText("Shares x 2");
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 0;
                                    gridBagConstraints.gridy = 3;
                                    gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
                                    gridBagConstraints.insets = new java.awt.Insets(0, 15, 0, 0);
                                    jPanel4.add(jLabel61231, gridBagConstraints);

                                    jTextField4.setEditable(false);
                                    jTextField4.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
                                    jTextField4.addActionListener(new java.awt.event.ActionListener() {
                                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                            jTextField4ActionPerformed(evt);
                                        }
                                    });

                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 1;
                                    gridBagConstraints.gridy = 3;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
                                    jPanel4.add(jTextField4, gridBagConstraints);

                                    jLabel59231.setText("Max. Loan - Ministry");
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 0;
                                    gridBagConstraints.gridy = 2;
                                    gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    gridBagConstraints.insets = new java.awt.Insets(0, 15, 0, 0);
                                    jPanel4.add(jLabel59231, gridBagConstraints);

                                    jTextField2.setEditable(false);
                                    jTextField2.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
                                    jTextField2.addActionListener(new java.awt.event.ActionListener() {
                                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                            jTextField2ActionPerformed(evt);
                                        }
                                    });

                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 1;
                                    gridBagConstraints.gridy = 2;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
                                    jPanel4.add(jTextField2, gridBagConstraints);

                                    jLabel14.setText("Prev Monthly Repayment");
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 3;
                                    gridBagConstraints.gridy = 1;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    jPanel4.add(jLabel14, gridBagConstraints);

                                    jTextField53.setEditable(false);
                                    jTextField53.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 4;
                                    gridBagConstraints.gridy = 1;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
                                    gridBagConstraints.ipadx = 50;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 20);
                                    jPanel4.add(jTextField53, gridBagConstraints);

                                    jLabel62231.setText("Additional Repayment Amt");
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 3;
                                    gridBagConstraints.gridy = 2;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    jPanel4.add(jLabel62231, gridBagConstraints);

                                    jTextField8.setEditable(false);
                                    jTextField8.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 4;
                                    gridBagConstraints.gridy = 2;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 20);
                                    jPanel4.add(jTextField8, gridBagConstraints);

                                    jLabel64231.setText("Monthly Total Repayment");
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 3;
                                    gridBagConstraints.gridy = 3;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    jPanel4.add(jLabel64231, gridBagConstraints);

                                    jTextField7.setEditable(false);
                                    jTextField7.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 4;
                                    gridBagConstraints.gridy = 3;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 20);
                                    jPanel4.add(jTextField7, gridBagConstraints);

                                    jLabel5.setText("Max. Loan - Sacco");
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 0;
                                    gridBagConstraints.gridy = 1;
                                    gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
                                    gridBagConstraints.insets = new java.awt.Insets(0, 15, 0, 0);
                                    jPanel4.add(jLabel5, gridBagConstraints);

                                    jTextField38.setEditable(false);
                                    jTextField38.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 1;
                                    gridBagConstraints.gridy = 1;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
                                    gridBagConstraints.ipadx = 50;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    jPanel4.add(jTextField38, gridBagConstraints);

                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 0;
                                    gridBagConstraints.gridy = 3;
                                    gridBagConstraints.gridwidth = 5;
                                    gridBagConstraints.gridheight = 3;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
                                    gridBagConstraints.insets = new java.awt.Insets(0, 10, 0, 10);
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 3.0;
                                    jPanel5231.add(jPanel4, gridBagConstraints);

                                    jPanel5.setLayout(new java.awt.GridBagLayout());

                                    jPanel5.setBorder(new javax.swing.border.LineBorder(new java.awt.Color(0, 0, 0), 1, true));
                                    jTextField11.setEditable(false);
                                    jTextField11.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 4;
                                    gridBagConstraints.gridy = 6;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
                                    gridBagConstraints.weightx = 2.0;
                                    gridBagConstraints.weighty = 1.0;
                                    gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
                                    jPanel5.add(jTextField11, gridBagConstraints);

                                    jLabel15211.setText("Yearly Loan Freq");
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 0;
                                    gridBagConstraints.gridy = 6;
                                    gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
                                    gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
                                    jPanel5.add(jLabel15211, gridBagConstraints);

                                    jTextField24.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 2;
                                    gridBagConstraints.gridy = 6;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
                                    gridBagConstraints.ipadx = 50;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    jPanel5.add(jTextField24, gridBagConstraints);

                                    jLabel63221.setText(" Present Net Salary x 2/3");
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 0;
                                    gridBagConstraints.gridy = 7;
                                    gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
                                    jPanel5.add(jLabel63221, gridBagConstraints);

                                    jTextField6.setEditable(false);
                                    jTextField6.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 2;
                                    gridBagConstraints.gridy = 7;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
                                    jPanel5.add(jTextField6, gridBagConstraints);

                                    jLabel6621.setText("Loan Type");
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 3;
                                    gridBagConstraints.gridy = 5;
                                    gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
                                    gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
                                    jPanel5.add(jLabel6621, gridBagConstraints);

                                    jTextField10.setEditable(false);
                                    jTextField10.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 4;
                                    gridBagConstraints.gridy = 5;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
                                    gridBagConstraints.weightx = 2.0;
                                    gridBagConstraints.weighty = 1.0;
                                    gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
                                    jPanel5.add(jTextField10, gridBagConstraints);

                                    jTextField49.setEditable(false);
                                    jTextField49.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 4;
                                    gridBagConstraints.gridy = 7;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
                                    jPanel5.add(jTextField49, gridBagConstraints);

                                    jLabel60221.setText("Valid Loan Security");
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 0;
                                    gridBagConstraints.gridy = 5;
                                    gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
                                    jPanel5.add(jLabel60221, gridBagConstraints);

                                    jTextField1.setEditable(false);
                                    jTextField1.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 2;
                                    gridBagConstraints.gridy = 5;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    jPanel5.add(jTextField1, gridBagConstraints);

                                    jLabel2522.setText("Loan Purpose");
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 3;
                                    gridBagConstraints.gridy = 6;
                                    gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
                                    gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
                                    jPanel5.add(jLabel2522, gridBagConstraints);

                                    jLabel12.setText("Rate %");
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 3;
                                    gridBagConstraints.gridy = 7;
                                    gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
                                    jPanel5.add(jLabel12, gridBagConstraints);

                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 0;
                                    gridBagConstraints.gridy = 6;
                                    gridBagConstraints.gridwidth = 5;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
                                    gridBagConstraints.insets = new java.awt.Insets(10, 10, 10, 10);
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 3.0;
                                    jPanel5231.add(jPanel5, gridBagConstraints);

                                    jTabbedPane1.addTab("Loan Details", jPanel5231);

                                    jPanel52221.setLayout(new java.awt.GridBagLayout());

                                    jPanel52221.setBorder(new javax.swing.border.TitledBorder(""));
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 0;
                                    gridBagConstraints.gridy = 7;
                                    gridBagConstraints.gridwidth = 5;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
                                    jPanel52221.add(jSeparator71221, gridBagConstraints);

                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 0;
                                    gridBagConstraints.gridy = 5;
                                    gridBagConstraints.gridwidth = 5;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
                                    gridBagConstraints.weightx = 1.0;
                                    jPanel52221.add(jSeparator5, gridBagConstraints);

                                    jLabel3.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 0;
                                    gridBagConstraints.gridy = 8;
                                    gridBagConstraints.gridwidth = 5;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
                                    gridBagConstraints.weightx = 1.0;
                                    jPanel52221.add(jLabel3, gridBagConstraints);

                                    jPanel7.setLayout(new java.awt.GridBagLayout());

                                    jPanel7.setBorder(new javax.swing.border.LineBorder(new java.awt.Color(0, 0, 0)));
                                    jLabel592221.setText("Total Value of Guarantee");
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 0;
                                    gridBagConstraints.gridy = 5;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    jPanel7.add(jLabel592221, gridBagConstraints);

                                    jTextField27.setEditable(false);
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 1;
                                    gridBagConstraints.gridy = 5;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    jPanel7.add(jTextField27, gridBagConstraints);

                                    jLabel622221.setText("No. of Guarantors");
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 3;
                                    gridBagConstraints.gridy = 5;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    jPanel7.add(jLabel622221, gridBagConstraints);

                                    jTextField28.setEditable(false);
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 4;
                                    gridBagConstraints.gridy = 5;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 20);
                                    jPanel7.add(jTextField28, gridBagConstraints);

                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 0;
                                    gridBagConstraints.gridy = 3;
                                    gridBagConstraints.gridwidth = 5;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 5.0;
                                    gridBagConstraints.insets = new java.awt.Insets(10, 10, 10, 10);
                                    jPanel52221.add(jPanel7, gridBagConstraints);

                                    jButton5.setFocusCycleRoot(true);
                                    jButton5.setMinimumSize(new java.awt.Dimension(0, 0));
                                    jButton5.setPreferredSize(new java.awt.Dimension(0, 0));
                                    jButton5.addActionListener(new java.awt.event.ActionListener() {
                                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                            jButton5ActionPerformed(evt);
                                        }
                                    });

                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 2;
                                    gridBagConstraints.gridy = 9;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    jPanel52221.add(jButton5, gridBagConstraints);

                                    jPanel8.setLayout(new java.awt.GridBagLayout());

                                    jPanel8.setBorder(new javax.swing.border.TitledBorder(null, "Loan Security (guarantee)", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Dialog", 1, 14), new java.awt.Color(0, 0, 255)));
                                    jScrollPane3.setViewportView(jTable2);

                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridwidth = 5;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 10.0;
                                    jPanel8.add(jScrollPane3, gridBagConstraints);

                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridwidth = 5;
                                    gridBagConstraints.gridheight = 3;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 7.0;
                                    gridBagConstraints.insets = new java.awt.Insets(10, 10, 10, 10);
                                    jPanel52221.add(jPanel8, gridBagConstraints);

                                    jTabbedPane1.addTab("Guarantors/Securities", jPanel52221);

                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridwidth = 7;
                                    gridBagConstraints.gridheight = 7;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
                                    gridBagConstraints.ipadx = 50;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 10.0;
                                    gridBagConstraints.insets = new java.awt.Insets(10, 10, 10, 10);
                                    getContentPane().add(jTabbedPane1, gridBagConstraints);

                                    jButton1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/check.gif")));
                                    jButton1.setMnemonic('A');
                                    jButton1.setText("Approve");
                                    jButton1.setToolTipText("Click here to enter data");
                                    buttonGroup1.add(jButton1);
                                    jButton1.addActionListener(new java.awt.event.ActionListener() {
                                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                            jButton1ActionPerformed(evt);
                                        }
                                    });

                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 0;
                                    gridBagConstraints.gridy = 11;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    getContentPane().add(jButton1, gridBagConstraints);

                                    jButton9.setIcon(new javax.swing.ImageIcon(getClass().getResource("/BD14757_.GIF")));
                                    jButton9.setMnemonic('r');
                                    jButton9.setText("Reject");
                                    buttonGroup1.add(jButton9);
                                    jButton9.addActionListener(new java.awt.event.ActionListener() {
                                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                            jButton9ActionPerformed(evt);
                                        }
                                    });

                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 1;
                                    gridBagConstraints.gridy = 11;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    getContentPane().add(jButton9, gridBagConstraints);

                                    jButton10.setIcon(new javax.swing.ImageIcon(getClass().getResource("/LARR-MAJ.GIF")));
                                    jButton10.setMnemonic('d');
                                    jButton10.setText("Defer");
                                    buttonGroup1.add(jButton10);
                                    jButton10.addActionListener(new java.awt.event.ActionListener() {
                                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                            jButton10ActionPerformed(evt);
                                        }
                                    });

                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 2;
                                    gridBagConstraints.gridy = 11;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    getContentPane().add(jButton10, gridBagConstraints);

                                    jButton252111.setIcon(new javax.swing.ImageIcon(getClass().getResource("/BD14755_.GIF")));
                                    jButton252111.setMnemonic('C');
                                    jButton252111.setText("Close");
                                    jButton252111.setToolTipText("Click here to close window");
                                    jButton252111.addActionListener(new java.awt.event.ActionListener() {
                                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                            jButton252111ActionPerformed(evt);
                                        }
                                    });

                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 4;
                                    gridBagConstraints.gridy = 11;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    getContentPane().add(jButton252111, gridBagConstraints);

                                    jLabel11.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 0;
                                    gridBagConstraints.gridy = 9;
                                    gridBagConstraints.gridwidth = 4;
                                    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    getContentPane().add(jLabel11, gridBagConstraints);

                                    jButton152111.setIcon(new javax.swing.ImageIcon(getClass().getResource("/note[1].gif")));
                                    jButton152111.setMnemonic('E');
                                    jButton152111.setText("Edit");
                                    jButton152111.setToolTipText("Click here to edit data & update");
                                    jButton152111.addActionListener(new java.awt.event.ActionListener() {
                                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                            jButton152111ActionPerformed(evt);
                                        }
                                    });

                                    gridBagConstraints = new java.awt.GridBagConstraints();
                                    gridBagConstraints.gridx = 3;
                                    gridBagConstraints.gridy = 11;
                                    gridBagConstraints.weightx = 1.0;
                                    gridBagConstraints.weighty = 1.0;
                                    getContentPane().add(jButton152111, gridBagConstraints);

                                    setBounds(0, 0, 800, 600);
                                }//GEN-END:initComponents

    private void jTextField48ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jTextField48ActionPerformed
        // Add your handling code here:
    }//GEN-LAST:event_jTextField48ActionPerformed

    private void datePicker1FocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_datePicker1FocusLost
   /*    
          float num_m = java.lang.Float.parseFloat(jTextField26.getText());
        
        float num_x = java.lang.Float.parseFloat(jTextField6.getText());
        
        
             if (num_m > num_x) {
                java.awt.Toolkit.getDefaultToolkit().beep();
                javax.swing.JOptionPane.showMessageDialog(this,"The System cannot allow loan more than the Net Salary x 2/3","Error Message!",javax.swing.JOptionPane.ERROR_MESSAGE);
                jTextField12.grabFocus();
           
            }
        */
         // Add your handling code        // Add your handling code here:
    }//GEN-LAST:event_datePicker1FocusLost

    private void jTextField4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jTextField4ActionPerformed
        // Add your handling code here:
    }//GEN-LAST:event_jTextField4ActionPerformed
    
    private void jTextField54ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jTextField54ActionPerformed
        // Add your handling code here:
    }//GEN-LAST:event_jTextField54ActionPerformed
    
    private void jButton411ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton411ActionPerformed
        jDialog1.setVisible(false);
        // Add your handling code here:
    }//GEN-LAST:event_jButton411ActionPerformed
    
    private void jButton211ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton211ActionPerformed
        
        java.lang.Object[] lists = null;
        lists = jList2.getSelectedValues();
        java.lang.String[] list_str = null;
        
        
        try {
            connectDB.setAutoCommit(false);
            for (int i = 0; i < lists.length; i++){
                java.sql.PreparedStatement pstmt = connectDB.prepareStatement("insert into rejected_defered_loans values(?,?,?,?,?,?)");
                pstmt.setString(1,jTextField48.getText());
                pstmt.setString(2,jTextField21.getText());
                pstmt.setString(3,jTextField15.getText());
                pstmt.setString(4,jTextField3.getText());
                pstmt.setString(5,lists[i].toString());
                pstmt.setString(6,"Defered");
                pstmt.executeUpdate();
            }
            
            java.sql.PreparedStatement pstmt = connectDB.prepareStatement("update loan_application set loan_status = 'Defered' where loan_account_no = '"+jTextField48.getText()+"'");
            
            pstmt.executeUpdate();
            
            java.sql.PreparedStatement pstt = connectDB.prepareStatement("DELETE from guarantors where lacc = '"+jTextField48.getText()+"'");
            
            pstt.executeUpdate();
            connectDB.commit();
            connectDB.setAutoCommit(true);
            
            {
               jTextField12.setText("0.00");
                jTextField7.setText("0.00");
                jTextField8.setText("0.00");
                jTextField9.setText("0.00");
                
            
            }
            
            //javax.swing.JOptionPane.showConfirmDialog(this, "The next loan is ?", "Confirm action", javax.swing.JOptionPane.YES_NO_OPTION);
            jDialog1.setVisible(false);
            
            int LoanNo = 0;
            
            java.sql.Statement stmt = connectDB.createStatement();
            java.sql.ResultSet rset = stmt.executeQuery("SELECT COUNT(*) from loan_application WHERE loan_status = 'Not Processed'");
            while (rset.next()){
                LoanNo = rset.getInt(1);
            }
            
            if (LoanNo < 1) {
                javax.swing.JOptionPane.showMessageDialog(this, "No more pending loan applications to process.");
            } else {
                 jTextField8.setText("0.00");
                jTextField9.setText("0.00");
                jTextField25.setText("0.00");
                jTextField29.setText("0.00");
                jTextField33.setText("0.00");
                jTextField26.setText("0.00");
                jButton5ActionPerformed(evt);
            }
            
            
        }   catch(java.sql.SQLException sq){
            javax.swing.JOptionPane.showMessageDialog(this,sq.getMessage(),"Error Message!",javax.swing.JOptionPane.ERROR_MESSAGE);
            try {
                connectDB.rollback();
            }catch (java.sql.SQLException sql){
                javax.swing.JOptionPane.showMessageDialog(this,sql.getMessage(),"Error Message!",javax.swing.JOptionPane.ERROR_MESSAGE);
            }
            System.out.println(sq.getMessage());
        }
        // Add your handling code here:
    }//GEN-LAST:event_jButton211ActionPerformed
    
    private void jButton42ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton42ActionPerformed
        jDialog3.setVisible(false);        // Add your handling code here:
    }//GEN-LAST:event_jButton42ActionPerformed
    
    private void jButton22ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton22ActionPerformed
        
        java.lang.Object[] lists = null;
        lists = jList1.getSelectedValues();
        java.lang.String[] list_str = null;
        
        
        try {
            connectDB.setAutoCommit(false);
            for (int i = 0; i < lists.length; i++){
                java.sql.PreparedStatement pstmt = connectDB.prepareStatement("insert into rejected_defered_loans values(?,?,?,?,?,?)");
                pstmt.setString(1,jTextField48.getText());
                pstmt.setString(2,jTextField21.getText());
                pstmt.setString(3,jTextField15.getText());
                pstmt.setString(4,jTextField3.getText());
                pstmt.setString(5,lists[i].toString());
                pstmt.setString(6,"Rejected");
                pstmt.executeUpdate();
                
                
                java.sql.PreparedStatement pstt = connectDB.prepareStatement("DELETE from guarantors where lacc = '"+jTextField48.getText()+"'");
                
                pstt.executeUpdate();
                
            }
            
            java.sql.PreparedStatement pstmt1 = connectDB.prepareStatement("update loan_application set loan_status = 'Rejected' where loan_account_no = '"+jTextField48.getText()+"'");
            
            pstmt1.executeUpdate();
            connectDB.commit();
            connectDB.setAutoCommit(true);
        }   catch(java.sql.SQLException sq){
            javax.swing.JOptionPane.showMessageDialog(this,sq.getMessage(),"Error Message!",javax.swing.JOptionPane.ERROR_MESSAGE);
            try {
                connectDB.rollback();
            }catch (java.sql.SQLException sql){
                javax.swing.JOptionPane.showMessageDialog(this,sql.getMessage(),"Error Message!",javax.swing.JOptionPane.ERROR_MESSAGE);
            }
            System.out.println(sq.getMessage());
        }
        
        
        {
            jTextField12.setText("0.00");
                jTextField7.setText("0.00");
                jTextField8.setText("0.00");
                jTextField9.setText("0.00");
                
             
            
        }
        
        jDialog3.setVisible(false);
        
        int LoanNo = 0;
        
        try {
            java.sql.Statement stmt = connectDB.createStatement();
            java.sql.ResultSet rset = stmt.executeQuery("SELECT COUNT(*) from loan_application WHERE loan_status = 'Not Processed'");
            while (rset.next()){
                LoanNo = rset.getInt(1);
            }
        } catch (java.sql.SQLException sqlEx) {
            
            javax.swing.JOptionPane.showMessageDialog(this, sqlEx.getMessage());
            
        }
        if (LoanNo < 1) {
            javax.swing.JOptionPane.showMessageDialog(this, "No more pending loan applications to process.");
        } else {
            jTextField8.setText("0.00");
                jTextField9.setText("0.00");
                jTextField25.setText("0.00");
                jTextField29.setText("0.00");
                jTextField33.setText("0.00");
                jTextField26.setText("0.00");
                
            jButton5ActionPerformed(evt);
        }
        
        
        // Add your handling code here:
    }//GEN-LAST:event_jButton22ActionPerformed
    
    private void formMouseEntered(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_formMouseEntered
        //jButton5ActionPerformed(evt);   // Add your handling code here:
    }//GEN-LAST:event_formMouseEntered
    
    private void jPanel52111ComponentShown(java.awt.event.ComponentEvent evt) {//GEN-FIRST:event_jPanel52111ComponentShown
        // jButton5ActionPerformed(evt); // Add your handling code here:
    }//GEN-LAST:event_jPanel52111ComponentShown
    
    private void jButton5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton5ActionPerformed
        int LoanNo = 0;
       /*if (jTextField48.getText() == "") {
          javax.swing.JOptionPane.showMessageDialog(this, "There are no pending loans to process.");
        } else {  */
        
        try {
            java.sql.Statement stmt = connectDB.createStatement();
            java.sql.ResultSet rset = stmt.executeQuery("SELECT COUNT(*) from loan_application WHERE loan_status = 'Not Processed'");
            while (rset.next()){
                LoanNo = rset.getInt(1);
            }
        } catch (java.sql.SQLException sqlEx) {
            
            javax.swing.JOptionPane.showMessageDialog(this, sqlEx.getMessage());
            
        }
        if (LoanNo < 1) {
            javax.swing.JOptionPane.showMessageDialog(this, "No pending loan applications to process.");
        } else {
            //This is the process of excuting a query when the approval,reject or defer actions has been excuted.
            javax.swing.JOptionPane.showMessageDialog(this, "The next loan is now ready to Process.", "System Information", javax.swing.JOptionPane.INFORMATION_MESSAGE);
            
            float float1;
            float float2;
            float float3;
            float float4;
            float float5;
            float float6;
            int j = 0;
            
            try {
                java.sql.Statement stmt = connectDB.createStatement();
                java.sql.ResultSet rset = stmt.executeQuery("SELECT loan_account_no from loan_application where loan_status = 'Not Processed' order by loan_account_no LIMIT 1");
                //where lacc ='"+jTextField48.getText()+"'");
                while (rset.next())
                    jTextField48.setText(rset.getObject(1).toString());
            } catch (java.sql.SQLException sq) {
                //sqe.printStackTrace();
                System.out.println(sq.getMessage());
            }
            try {
                java.sql.Statement stmt = connectDB.createStatement();
                java.sql.ResultSet res = stmt.executeQuery("select member_name,department,workstation,position_in_sacco,service_terms,birth_date,loan_purpose,"+
                "repayment_period,round(monthly_income* (2)/3::NUMERIC),member_no,loan_amount,UPPER(loan_type),"+
               
                "commencement_date,loan_account_no,rate,monthly_repayment_amount,applicant_shares from loan_application WHERE loan_status ='Not Processed'  AND loan_account_no ilike '"+jTextField48.getText()+"' order by loan_account_no");
          //lpad(member_no,9,0)
            while (res.next()){
              
                jTextField21.setText(res.getObject(1).toString());
                jTextField17.setText(res.getObject(2).toString());
                jTextField20.setText(res.getObject(3).toString());
                jTextField19.setText(res.getObject(4).toString());
                jTextField18.setText(res.getObject(5).toString());
                jTextField22.setText(res.getObject(6).toString());
                jTextField11.setText(res.getObject(7).toString());
                jTextField5.setText(res.getObject(8).toString());
                jTextField6.setText(res.getObject(9).toString());
                jTextField15.setText(res.getObject(10).toString());
                jTextField3.setText(res.getObject(11).toString());
                jTextField10.setText(res.getObject(12).toString());
                jTextField33.setText(res.getObject(13).toString());
                jTextField48.setText(res.getObject(14).toString());
                jTextField49.setText(res.getObject(15).toString());
                jTextField8.setText(res.getObject(16).toString());
                jTextField4.setText(res.getObject(17).toString());
            // jTextField24
            }
            res.close();
            stmt.close();
           // con.close();

        }   catch(java.sql.SQLException sq){
            System.out.println(sq.getMessage());
        } 
       try {
           java.sql.Statement st4 = connectDB.createStatement();
               
              java.sql.ResultSet rs4 = st4.executeQuery("select COUNT(payroll_no) from member_shares_view2 where payroll_no ilike'"+jTextField15.getText()+"'");
            
            while (rs4.next()) {
           j = rs4.getInt(1);
           } 
           if (j > 0) {
         
           //try {    
                  
       // crset13.setCommand("SELECT share_type,sum(credit) as amount from shares_transactions where member_code = '"+jTextField15.getText()+"' group by share_type");
crset13.setCommand("SELECT share_type,amount from member_shares_view2 where payroll_no ilike '"+jTextField15.getText()+"' and share_type ilike 'NORMAL SHARES'");
//crset13.setCommand("SELECT share_type,sum(credit-debit) as amount from shares_transactions where member_code = '"+jTextField15.getText()+"' and share_type ilike 'Normal Shares' group by share_type");
               crset13.setConnectionSource(pConnDB);
    
       // try {
            crset13.execute();
        
       // crset2.setExecuteOnLoad(true);
        jTable1.setModel(new org.netbeans.lib.sql.models.TableModel(crset13, new org.netbeans.lib.sql.models.TableModel.Column[] {
            new org.netbeans.lib.sql.models.TableModel.Column("share_type", "Share Type", false),
            new org.netbeans.lib.sql.models.TableModel.Column("amount", "Amount", false)
        }));
        jScrollPane2.setViewportView(jTable1);
   
            }
         } catch(java.sql.SQLException sqlExec) {
            
            javax.swing.JOptionPane.showMessageDialog(this, sqlExec.getMessage());
            
        } 
        
            
           try {
            java.sql.Statement stmt = connectDB.createStatement();
            java.sql.ResultSet rset = stmt.executeQuery("SELECT sum(credit)-sum(debit) from shares_transactions where share_type !='Entrance Fee' AND payroll_no ilike'"+jTextField15.getText()+"'");
            //where lacc ='"+jTextField48.getText()+"'");
            while (rset.next())
              jTextField37.setText(rset.getObject(1).toString());
            } catch (java.sql.SQLException sq) {
           //sqe.printStackTrace();
            System.out.println(sq.getMessage());
        }
         
           
             try {
          java.sql.Statement stmt = connectDB.createStatement();
            java.sql.ResultSet rset = stmt.executeQuery("select COUNT (lacc) from guarantors where lacc ilike'"+jTextField48.getText()+"'");
            //where lacc ='"+jTextField48.getText()+"'");
            while (rset.next())
              jTextField28.setText(rset.getObject(1).toString());
            } catch (java.sql.SQLException sq) {
           //sqe.printStackTrace();
            System.out.println(sq.getMessage());
        } 
           
            try {
           java.sql.Statement stmt = connectDB.createStatement();
               //java.sql.ResultSet rset = stmt.executeQuery("select ((ml.rate/100) * (SELECT sum(credit - debit) from shares_transactions WHERE member_name !='Opening Balance'))::numeric(30,2) from max_loan_allowable ml WHERE ml.rate !=0");
           
           java.sql.ResultSet rset = stmt.executeQuery("select amount from max_loan_allowable WHERE loan_type ilike'"+jTextField10.getText()+"'");
         //where lacc ='"+jTextField48.getText()+"'");
            while (rset.next())
              jTextField2.setText(rset.getObject(1).toString());
            } catch (java.sql.SQLException sq) {
           //sqe.printStackTrace();
            System.out.println(sq.getMessage());
        } 
           
          try {
           java.sql.Statement stmt = connectDB.createStatement();
               java.sql.ResultSet rset = stmt.executeQuery("select amount from max_loan_allowable WHERE loan_type ilike'"+jTextField10.getText()+"'");
         //where lacc ='"+jTextField6.getText()+"'");
            while (rset.next())
              jTextField38.setText(rset.getObject(1).toString());
            } catch (java.sql.SQLException sq) {
           //sqe.printStackTrace();
            System.out.println(sq.getMessage());
        } 
        
           try {
           java.sql.Statement stmt = connectDB.createStatement();
            java.sql.ResultSet rset = stmt.executeQuery("select COUNT (staff_no) from loan_details_stmt_view where loan_no ilike '"+jTextField48.getText()+"' and balance > 10.00");
            //where lacc ='"+jTextField24.getText()+"'");
            while (rset.next())
              jTextField24.setText(rset.getObject(1).toString());
            } catch (java.sql.SQLException sq) {
           //sqe.printStackTrace();
            System.out.println(sq.getMessage());
        }
        
  
         try {
            java.sql.Statement st4 = connectDB.createStatement();
            java.sql.Statement stmt3 = connectDB.createStatement();
            java.sql.ResultSet rs4 = st4.executeQuery("select COUNT(lacc) from guarantors where lacc ilike'"+jTextField48.getText()+"'");
            java.sql.ResultSet rset = stmt3.executeQuery("select sum(amount) from guarantors where lacc ilike'"+jTextField48.getText()+"'");
          
            while (rs4.next()) {
            j = rs4.getInt(1);
            }
             if (j > 0) {
             while (rset.next()){
                
             jTextField27.setText(rset.getObject(1).toString());
             }   
            
             } else { 
                       
           // java.sql.Statement stmt4 = connectDB.createStatement();
             //java.sql.ResultSet rset1 = stmt4.executeQuery("select property_value from property_details where loan_acc_no ilike'"+jTextField48.getText()+"'");
          
           //         while (rset1.next()){
                
             //jTextField27.setText(rset1.getObject(1).toString());
           //    System.out.println(rset1.getObject(1).toString()); 
            
             
         //    }
             jTextField27.setText("0.00");
               
                 }
          } catch (java.sql.SQLException sq) {
           //sqe.printStackTrace();
             } 
          
 
           
         try {
             java.sql.Statement stmt = connectDB.createStatement();
             java.sql.Statement stm1 = connectDB.createStatement();
            java.sql.Statement stm2 = connectDB.createStatement();

            java.sql.ResultSet rs2 = stm2.executeQuery("select COUNT(member_no) from loan_transactions where member_no ilike'"+jTextField15.getText()+"'");
            while (rs2.next()) {
            j = rs2.getInt(1);
            }
             if (j > 0) {
            java.sql.ResultSet rset = stmt.executeQuery("select SUM(principal - principal_paid) from loan_transactions where member_no ilike'"+jTextField15.getText()+"'");
            while (rset.next())
            jTextField23.setText(rset.getObject(1).toString());
             } else {
                jTextField23.setText("0.00");
             }             
            java.sql.Statement stm3 = connectDB.createStatement(); 
            java.sql.ResultSet rs21 = stm3.executeQuery("select COUNT(member_no) from approved_loans where member_no ilike'"+jTextField15.getText()+"'");
            while (rs21.next()) {
            j = rs21.getInt(1);
            }
             if (j > 0) {
            java.sql.ResultSet rs31 = stm1.executeQuery("select SUM(monthly_repayment) from approved_loans where member_no ilike'"+jTextField15.getText()+"'");
            while (rs31.next())
           jTextField53.setText(rs31.getObject(1).toString());
        
             } else {
                jTextField53.setText("0.00");
             }
            
            
            
            
        float num_a = java.lang.Float.parseFloat(jTextField37.getText());
       // float num_b = java.lang.Float.parseFloat(jTextField14.getText());
       // float num_c = java.lang.Float.parseFloat(jTextField13.getText());
      //  float num_d = java.lang.Float.parseFloat(jTextField37.getText());
       // float num_e = (num_a + num_b + num_c);
       // jTextField37.setText(Float.toString(num_e));
        float num_d = (num_a) * 2;
        jTextField4.setText(Float.toString(num_d));
             } catch (java.sql.SQLException sq) {
           //sqe.printStackTrace();
             } 
       
        
         try {
           java.sql.Statement st4 = connectDB.createStatement();
               
               java.sql.ResultSet rs4 = st4.executeQuery("select COUNT(lacc) from guarantors where lacc ilike '"+jTextField48.getText()+"'");
             
            while (rs4.next()) {
           j = rs4.getInt(1);
           }
            if (j > 0) {
             
           //try {
                  
        crset12.setCommand("select gnumber,amount from guarantors where lacc ilike'"+jTextField48.getText()+"'");
        crset12.setConnectionSource(pConnDB);
    
       // try {
            crset12.execute();
        
       // crset2.setExecuteOnLoad(true);
        jTable2.setModel(new org.netbeans.lib.sql.models.TableModel(crset12, new org.netbeans.lib.sql.models.TableModel.Column[] {
            new org.netbeans.lib.sql.models.TableModel.Column("gnumber", "Guarantor Membership No.", false),
            new org.netbeans.lib.sql.models.TableModel.Column("amount", "Amount guaranteed", false)
        }));
        jScrollPane3.setViewportView(jTable2);
   
            }
         } catch(java.sql.SQLException sqlExec) {
            
            javax.swing.JOptionPane.showMessageDialog(this, sqlExec.getMessage());
            
        } 
          
        try {
           java.sql.Statement st4 = connectDB.createStatement();
               
           java.sql.Statement stmt4 = connectDB.createStatement();
            java.sql.ResultSet rs4 = st4.executeQuery("select COUNT(loan_account_no) from loans_security where loan_account_no ilike '"+jTextField48.getText()+"'");
             java.sql.ResultSet rset1 = stmt4.executeQuery("SELECT sum(security_rate * amount) from loans_security where loan_account_no ilike '"+jTextField48.getText()+"'");
            
            while (rs4.next()) {
           j = rs4.getInt(1);
           }
            if (j > 0) {
           
                while (rset1.next()){
            jTextField27.setText(rset1.getObject(1).toString());
                }
           //try {
                  
        crset5.setCommand("SELECT security_type,registration_no,amount,(security_rate * amount) as scaled_value from loans_security where loan_account_no ilike '"+jTextField48.getText()+"' GROUP BY security_type,registration_no,amount,security_rate");
        crset5.setConnectionSource(pConnDB);
    
       // try {
            crset5.execute();
        
       // crset2.setExecuteOnLoad(true);
        jTable2.setModel(new org.netbeans.lib.sql.models.TableModel(crset5, new org.netbeans.lib.sql.models.TableModel.Column[] {
            new org.netbeans.lib.sql.models.TableModel.Column("security_type", "Security_type", false),
            new org.netbeans.lib.sql.models.TableModel.Column("registration_no", "Registration N0.", false),
            new org.netbeans.lib.sql.models.TableModel.Column("amount", "Amount", false),
            new org.netbeans.lib.sql.models.TableModel.Column("scaled_value", "Scaled Value", false)
        }));
        jScrollPane3.setViewportView(jTable2);
   
            }
         } catch(java.sql.SQLException sqlExec) {
            
            javax.swing.JOptionPane.showMessageDialog(this, sqlExec.getMessage());
            
        } 
        
           try {
           java.sql.Statement st4 = connectDB.createStatement();
               
              java.sql.ResultSet rs5 = st4.executeQuery("select COUNT(loan_acc_no) from property_details where loan_acc_no ilike '"+jTextField48.getText()+"'");
              
            while (rs5.next()) {
           j = rs5.getInt(1);
           }
            if (j > 0) {
            
           
        crset7.setCommand("SELECT reg_no,property_no,property_desc,property_value from property_details where loan_acc_no ilike '"+jTextField48.getText()+"'");
        crset7.setConnectionSource(pConnDB);
    
       // try {
            crset7.execute();
        
       // crset2.setExecuteOnLoad(true);
        jTable2.setModel(new org.netbeans.lib.sql.models.TableModel(crset7, new org.netbeans.lib.sql.models.TableModel.Column[] {
            new org.netbeans.lib.sql.models.TableModel.Column("reg_no", "Registration_no", false),
            new org.netbeans.lib.sql.models.TableModel.Column("property_no", "Property N0.", false),
            new org.netbeans.lib.sql.models.TableModel.Column("property_desc", "Description", false),
            new org.netbeans.lib.sql.models.TableModel.Column("property_value", "Value", false)
        }));
        jScrollPane3.setViewportView(jTable2);
   
            }
         } catch(java.sql.SQLException sqlExec) {
            
            javax.swing.JOptionPane.showMessageDialog(this, sqlExec.getMessage());
            
        } 
        
        float num_g = java.lang.Float.parseFloat(jTextField27.getText());
        float num_x = java.lang.Float.parseFloat(jTextField37.getText());
        float num_k = num_g + num_x;
        jTextField1.setText(Float.toString(num_k));
        }
        
        // Add your handling code here:
    }//GEN-LAST:event_jButton5ActionPerformed
    
    private void jButton10ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton10ActionPerformed
        int resOpt = javax.swing.JOptionPane.showConfirmDialog(this, "Are you sure you want to defer the loan ?", "Confirm action", javax.swing.JOptionPane.YES_NO_OPTION);
        
        if (resOpt == javax.swing.JOptionPane.YES_OPTION) {
            
            javax.swing.JOptionPane.showMessageDialog(this, "Click ok and select a reasons from the dialog.");
            jDialog1.setVisible(true);
        }
        
        // jDialog2.setVisible(true);
        // Add your handling code here:
    }//GEN-LAST:event_jButton10ActionPerformed
    
    private void jButton152111ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton152111ActionPerformed
        
        javax.swing.JFrame loanappr = new PersonalInformation(connectDB,pConnDB);
        loanappr.setVisible(true);      // Add your handling code here:
    }//GEN-LAST:event_jButton152111ActionPerformed
    
    private void jTextField12KeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTextField12KeyReleased
        float num_b = java.lang.Float.parseFloat(jTextField12.getText());
          float num_a = java.lang.Float.parseFloat(jTextField5.getText());
        float num_h = java.lang.Float.parseFloat(jTextField3.getText());
        float num_n = java.lang.Float.parseFloat(jTextField2.getText());
        float num_f = java.lang.Float.parseFloat(jTextField38.getText());
        float num_x = java.lang.Float.parseFloat(jTextField6.getText());
        float num_k = java.lang.Float.parseFloat(jTextField4.getText());
         float period = java.lang.Float.parseFloat(jTextField5.getText());
        float rate = java.lang.Float.parseFloat(jTextField49.getText());
         float moth = java.lang.Float.parseFloat(jTextField8.getText());
          float loanBal = java.lang.Float.parseFloat(jTextField23.getText());
        float total_int = 00;
        float intr = 00;
        float totalpymt = 00;
        
        if (loanBal < 0) {
               jTextField23.setText("0.00");
        }
        
        String propLoan ="Property Loan";
        
        if (num_b > num_h) {
            java.awt.Toolkit.getDefaultToolkit().beep();
            javax.swing.JOptionPane.showMessageDialog(this,"The System cannot allow loan amount more than the applied amount","Error Message!",javax.swing.JOptionPane.ERROR_MESSAGE);
            jTextField12.setText("");
        }
        
        
        float total_num = num_b/num_a;
        //double rep = num_b/num_a;
       // double total_num = 0.00;
       //  total_num = rep + total_num/12;
        
        System.out.println(total_num);
        jTextField8.setText(""+total_num+"");
        float num_d = java.lang.Float.parseFloat(jTextField8.getText());
        float num_e = java.lang.Float.parseFloat(jTextField53.getText());
        float sum_a = num_d + num_e;
        jTextField7.setText(""+sum_a+"");
        
        // float num_f = java.lang.Float.parseFloat(jTextField12.getText());
        float num_g = java.lang.Float.parseFloat(jTextField23.getText());
        float total_ln = num_b + num_g;
        jTextField9.setText(""+total_ln+"");
        
         double p = java.lang.Double.parseDouble(jTextField12.getText().toString());
         double n = java.lang.Double.parseDouble(jTextField5.getText().toString());
         double r = java.lang.Double.parseDouble(jTextField49.getText().toString())/12;
         double amount = 0.00;
         double total = 0.00;
         total = r*p/100;
         double inst = 0.00;
         inst = p/n;
         for (int i = 1; i <= n ; i++){
        // amount = r/100*java.lang.Math.pow((1-(r/100)),n);
             amount = r/100*((p-(p/n)*(i-1)));
             total = total + amount; 
          System.out.println("Intrest: ["+amount+"]");
          System.out.println(" Total Intrest: ["+total+"]");
         }  
       
             this.jTextField25.setText(""+total);
         // this.jTextField33.setText(""+inst);
          double monthinst = 0.00;
         monthinst = total/n;
          double totalmonthinst = 0.00;
          this.jTextField29.setText(""+inst);
         totalmonthinst = monthinst+inst;
          this.jTextField33.setText(""+monthinst);
           this.jTextField26.setText(""+totalmonthinst);
        if (!(jTextField10.getText().equals(propLoan))) {
            
            if (num_b > num_n) {
                java.awt.Toolkit.getDefaultToolkit().beep();
                javax.swing.JOptionPane.showMessageDialog(this,"The System cannot loan more than the Ministry maximum amount","Error Message!",javax.swing.JOptionPane.ERROR_MESSAGE);
                jTextField12.setText("");
            }
            if (num_b > num_f) {
                java.awt.Toolkit.getDefaultToolkit().beep();
                javax.swing.JOptionPane.showMessageDialog(this,"The System cannot loan more than the Sacco maximum amount","Error Message!",javax.swing.JOptionPane.ERROR_MESSAGE);
                jTextField12.setText("");
            }
            if (num_b > num_k) {
                java.awt.Toolkit.getDefaultToolkit().beep();
                javax.swing.JOptionPane.showMessageDialog(this,"The System cannot allow loan more than the Shares x 2","Error Message!",javax.swing.JOptionPane.ERROR_MESSAGE);
                jTextField12.setText("");
            }
          /*   if (num_m > num_x) {
                java.awt.Toolkit.getDefaultToolkit().beep();
                javax.swing.JOptionPane.showMessageDialog(this,"The System cannot allow loan more than the Net Salary x 2/3","Error Message!",javax.swing.JOptionPane.ERROR_MESSAGE);
                jTextField12.setText("");
           
            }
           */
            
           
        }
        
        // Add your handling code here:
    }//GEN-LAST:event_jTextField12KeyReleased
    
    private void jButton252111ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton252111ActionPerformed
        setVisible(false);  // Add your handling code here:
    }//GEN-LAST:event_jButton252111ActionPerformed
    
    private void jTextField12KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTextField12KeyTyped
        
    }//GEN-LAST:event_jTextField12KeyTyped
    
    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
 int loanFreq = java.lang.Integer.parseInt(jTextField24.getText());
      
        if(loanFreq > 0){
    
   java.awt.Toolkit.getDefaultToolkit().beep();
   javax.swing.JOptionPane.showMessageDialog(this,"The System cannot allow another loan before clearing the previous one","Error Message!",javax.swing.JOptionPane.ERROR_MESSAGE);
                
        
}else{ 
        float num_m = java.lang.Float.parseFloat(jTextField26.getText());
        
        float num_x = java.lang.Float.parseFloat(jTextField6.getText());
        
        
             if (num_m > num_x) {
                java.awt.Toolkit.getDefaultToolkit().beep();
                javax.swing.JOptionPane.showMessageDialog(this,"The System cannot allow loan more than the Net Salary x 2/3","Error Message!",javax.swing.JOptionPane.ERROR_MESSAGE);
                jTextField12.grabFocus();
           
            
        
        
    }else{ 
        
        int resOpt = javax.swing.JOptionPane.showConfirmDialog(this, "Are you sure you want to approve the loan ?", "Confirm action", javax.swing.JOptionPane.YES_NO_OPTION);
        
        if (resOpt == javax.swing.JOptionPane.YES_OPTION) {
            
            javax.swing.JOptionPane.showMessageDialog(this, "You only need to click ok.");
            
            
            java.util.Calendar calendar = java.util.Calendar.getInstance();
            
            long dateNow = calendar.getTimeInMillis();
            
            java.sql.Date datenowSql= new java.sql.Date(dateNow);
            
            String apprNo = null;
            String refNo = null;
            String userName = null;
            String loanCode = null;
            String memberNo = null;
            String intrestCode = null;
            try {
                
                
                
                
                
                connectDB.setAutoCommit(false);
             /*   java.sql.Statement stm = connectDB.createStatement();
                java.sql.ResultSet rsetA = stm.executeQuery("select code from activity where activity ='Interest From Loans'");
                while (rsetA.next()){
                    rsetA.getObject(1).toString();
                //rsetA.close();
                
                intrestCode = rsetA.getObject(1).toString();
                }
                
                */
                java.sql.Statement stm1 = connectDB.createStatement();
                java.sql.ResultSet rsetB = stm1.executeQuery("select code from activity where activity ='"+jTextField10.getText().toString()+"'");
                
                
                while (rsetB.next()){
                    loanCode = rsetB.getObject(1).toString();
                }
                
                java.sql.Statement stm1M = connectDB.createStatement();
                java.sql.ResultSet rsetM = stm1M.executeQuery("select m_number from member where payroll_no ='"+jTextField15.getText().toString()+"'");
                while (rsetM.next()){
                    memberNo = rsetM.getObject(1).toString();
                }
                
                
                
                java.sql.Statement stmt = connectDB.createStatement();
                java.sql.ResultSet res =stmt.executeQuery("select nextval('loan_approval_seq')");
                while (res.next()){
                    apprNo = res.getObject(1).toString();
                }
                 java.sql.Statement stmtw = connectDB.createStatement();
                java.sql.ResultSet resw =stmtw.executeQuery("select nextval('transaction_no_seq')");
                while (resw.next()){
                    refNo = resw.getObject(1).toString();
                }
                
                
                 java.sql.Statement stmtw1 = connectDB.createStatement();
                java.sql.ResultSet resw1 =stmtw1.executeQuery("select current_user");
                while (resw1.next()){
                    userName = resw1.getObject(1).toString();
                }
                
                java.sql.PreparedStatement pstmt = connectDB.prepareStatement("insert into approved_loans values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)");
               
                
                //pstmt.setString(1,jTextField48.getText());
                pstmt.setString(1,memberNo);
                pstmt.setString(2,jTextField15.getText());
                pstmt.setString(3,jTextField21.getText());
                pstmt.setString(4,jTextField10.getText());
                pstmt.setString(5,jTextField12.getText());
                pstmt.setString(6,jTextField5.getText());
                pstmt.setString(7,jTextField26.getText());
                pstmt.setString(8,jTextField1.getText());
                pstmt.setString(9,jTextField49.getText());
                pstmt.setString(10,jTextField27.getText());
                 pstmt.setString(11,datePicker1.getDate().toString());
                pstmt.setString(12, "now");
                pstmt.setString(13,jTextField48.getText());
                pstmt.setString(14,"FALSE");
                 pstmt.setString(15,"FALSE");
                  pstmt.setString(16,jTextField33.getText());
                 pstmt.setString(17,jTextField29.getText());
                pstmt.executeUpdate();
                
                
                java.sql.PreparedStatement pstmt7 = connectDB.prepareStatement("insert into guarantors values(?,?,?,initcap(?))");
                for (int i = 0; i < jTable1.getRowCount(); i++){
                    if (jTable1.getModel().getValueAt(i,0) != null){
                        pstmt7.setObject(4,jTable1.getValueAt(i,0).toString());
                        pstmt7.setObject(2,jTable1.getValueAt(i,1));
                        pstmt7.setString(1,jTextField15.getText());
                        pstmt7.setObject(3,jTextField48.getText());
                        pstmt7.executeUpdate();
                        
                    }
                }
                
                float num_1 = java.lang.Float.parseFloat(jTextField12.getText());
                float num_2 = java.lang.Float.parseFloat(jTextField49.getText());
                float num_3 = java.lang.Float.parseFloat("1200");
                float total_num = num_1*num_2/num_3;
                
               double initDebit = 0.00;
                java.lang.Double.parseDouble(jTextField25.getText().toString());
                java.lang.Double.parseDouble(jTextField12.getText().toString());
                initDebit = java.lang.Double.parseDouble(jTextField12.getText().toString())+java.lang.Double.parseDouble(jTextField25.getText().toString());
                      
                java.sql.PreparedStatement pstmt1 = connectDB.prepareStatement("insert into loan_transactions values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)");
                pstmt1.setString(1,jTextField48.getText());
                pstmt1.setString(2,jTextField21.getText());
                pstmt1.setString(3,jTextField15.getText());
                pstmt1.setString(4,jTextField10.getText());
                pstmt1.setString(5,"");
                pstmt1.setString(6,"");
                pstmt1.setString(7,"");
                pstmt1.setString(8,"");
                pstmt1.setString(9,"");
                pstmt1.setString(10,"");
                pstmt1.setString(11,"");
                pstmt1.setString(12,jTextField12.getText());
                pstmt1.setString(13,jTextField8.getText());
                 pstmt1.setString(14,jTextField33.getText());
                pstmt1.setString(15,"0.00");
                pstmt1.setString(16,"0.00");
                pstmt1.setDouble(17,initDebit);
                pstmt1.setString(18,"0.00");
                pstmt1.setString(19,"0.00");
                pstmt1.setString(20,"Loan Approval");
                pstmt1.setString(21,"0.00");
                pstmt1.setString(22,""+loanCode+"");
                pstmt1.setString(23,"'now'");
                pstmt1.setString(24,refNo);
                pstmt1.setBoolean(25,false);
                pstmt1.setString(26,"");
                pstmt1.setString(27,datePicker1.getDate().toString());
                pstmt1.setString(28,"0.00");
                pstmt1.setDouble(29,initDebit);
                pstmt1.setString(30,jTextField25.getText());
                pstmt1.executeUpdate();
                
            
                
                java.sql.PreparedStatement pstmt1d = connectDB.prepareStatement("insert into ac_deposits values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)");
               
                double bal = 0.00;
                java.lang.Double.parseDouble(jTextField25.getText().toString());
                java.lang.Double.parseDouble(jTextField12.getText().toString());
                bal = java.lang.Double.parseDouble(jTextField12.getText().toString())+java.lang.Double.parseDouble(jTextField25.getText().toString());
                
                pstmt1d.setString(1,loanCode);
                pstmt1d.setString(2,jTextField21.getText());
                pstmt1d.setString(3,jTextField10.getText());
                pstmt1d.setString(4,jTextField15.getText());
                pstmt1d.setString(5,jTextField21.getText());
                pstmt1d.setString(6,jTextField11.getText());
                pstmt1d.setString(7,memberNo);
                pstmt1d.setString(8,"");
                pstmt1d.setString(9,"");
                pstmt1d.setString(10,"");
                pstmt1d.setString(11,refNo);
                pstmt1d.setString(12,"Loan Approval");
                pstmt1d.setDouble(13,bal);
                pstmt1d.setString(14,"0.00");
                pstmt1d.setString(15,"now");
                 pstmt1d.setString(16,jTextField48.getText());
                pstmt1d.setString(17,jTextField10.getText());
                pstmt1d.setBoolean(18,true);
                pstmt1d.setBoolean(19,false);
                pstmt1d.setString(20,userName);
                pstmt1d.setString(21,"");
                pstmt1d.setDouble(22,bal);
                pstmt1d.setBoolean(23,false);
                pstmt1d.setString(24,"0.00");
                pstmt1d.setString(25,apprNo);
                pstmt1d.setString(26,datePicker1.getDate().toString());
                pstmt1d.setString(27,"false");
                pstmt1d.setString(28,"0.00");
                pstmt1d.setString(29,null);
                pstmt1d.setString(30,"");
                pstmt1d.setBoolean(31,false);
                pstmt1d.setString(32,"0.00");
                pstmt1d.setString(33,null);
                pstmt1d.setString(34,"");
                pstmt1d.executeUpdate();
                 
                  
                java.sql.PreparedStatement pstmt4 = connectDB.prepareStatement("update loan_application set loan_status = 'Approved' where loan_account_no = '"+jTextField48.getText()+"'");
                
                pstmt4.executeUpdate();
                
                
                   java.sql.PreparedStatement pstmt812s = connectDB.prepareStatement("UPDATE lrepayment_update SET  balance = '"+jTextField12.getText()+"' where payroll_no = '"+jTextField15.getText()+"'");
                                pstmt812s.executeUpdate();
                               
                
                connectDB.commit();
                connectDB.setAutoCommit(true);
                jLabel11.setForeground(java.awt.Color.blue);
                jLabel11.setText("Insert successful");
                
            }   catch(java.sql.SQLException sq){
        sq.printStackTrace();
        javax.swing.JOptionPane.showMessageDialog(this,sq.getMessage(),"Error Message!",javax.swing.JOptionPane.ERROR_MESSAGE);
                
                try {
                    connectDB.rollback();
                }catch (java.sql.SQLException sql){
                    
                    sql.printStackTrace();
                    javax.swing.JOptionPane.showMessageDialog(this,sql.getMessage(),"Error Message!",javax.swing.JOptionPane.ERROR_MESSAGE);
                }
                System.out.println(sq.getMessage());
            } {
                 jTextField8.setText("0.00");
                jTextField9.setText("0.00");
                jTextField25.setText("0.00");
                jTextField29.setText("0.00");
                jTextField33.setText("0.00");
                jTextField26.setText("0.00");
            }
            jButton5ActionPerformed(evt);
            
        }
    }
        
}
// Add your handling code here:
    }//GEN-LAST:event_jButton1ActionPerformed
    
    private void jButton9ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton9ActionPerformed
        int resOptt = javax.swing.JOptionPane.showConfirmDialog(this, "Are you sure you want to reject the loan ?", "Confirm action", javax.swing.JOptionPane.YES_NO_OPTION);
        
        if (resOptt == javax.swing.JOptionPane.YES_OPTION) {
            
            javax.swing.JOptionPane.showMessageDialog(this, "Click ok and select the reason from the dialog.");
            
            
            jDialog3.setVisible(true);
            //jDialog1.setSize(400,400);
        }
        
        
        // Add your handling code here:
    }//GEN-LAST:event_jButton9ActionPerformed
    
    private void jTextField2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jTextField2ActionPerformed
        // Add your handling code here:
    }//GEN-LAST:event_jTextField2ActionPerformed
    
    //  public String getSqlString(java.lang.Object insertloan) {
    
    
    // }
    
    
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JTextField jTextField6;
    private javax.swing.JLabel jLabel58231;
    private javax.swing.JTextField jTextField25;
    private javax.swing.JLabel jLabel25121;
    private javax.swing.JSeparator jSeparator7131;
    private javax.swing.JTextField jTextField37;
    private javax.swing.JTextField jTextField7;
    private javax.swing.JTextField jTextField26;
    private javax.swing.JLabel jLabel152;
    private javax.swing.JTextField jTextField3;
    private javax.swing.JLabel jLabel1511;
    private javax.swing.JTextField jTextField27;
    private javax.swing.JTextField jTextField19;
    private javax.swing.JTextField jTextField24;
    private javax.swing.JTextField jTextField5;
    private javax.swing.JButton jButton252111;
    private javax.swing.JButton jButton9;
    private javax.swing.JButton jButton10;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JTextField jTextField38;
    private javax.swing.JLabel jLabel582111;
    private javax.swing.JTextField jTextField2;
    private javax.swing.JLabel jLabel6621;
    private javax.swing.JTextField jTextField15;
    private javax.swing.JTextField jTextField1;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel622111;
    private org.netbeans.lib.sql.NBCachedRowSet crset3;
    private javax.swing.JTextField jTextField48;
    private javax.swing.JLabel jLabel15211;
    private javax.swing.JLabel jLabel62231;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JLabel jLabel1;
    private org.netbeans.lib.sql.NBCachedRowSet crset2;
    private javax.swing.JTextField jTextField22;
    private javax.swing.JTextField jTextField49;
    private javax.swing.JLabel jLabel65231;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JButton jButton1;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JTextField jTextField11;
    private javax.swing.JPanel jPanel8;
    private javax.swing.JLabel jLabel2522;
    private org.netbeans.lib.sql.NBCachedRowSet crset11;
    private javax.swing.JLabel jLabel57231;
    public javax.swing.JButton jButton5;
    private javax.swing.JTextField jTextField23;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel5922111;
    private javax.swing.JLabel jLabel61231;
    private javax.swing.JLabel jLabel7;
    private javax.swing.ButtonGroup buttonGroup1;
    private javax.swing.JButton jButton152111;
    private javax.swing.JDialog jDialog3;
    private org.netbeans.lib.sql.NBCachedRowSet crset1;
    private javax.swing.JTextField jTextField21;
    private javax.swing.JScrollPane jScrollPane111;
    private com.afrisoftech.lib.DatePicker datePicker1;
    private javax.swing.JLabel jLabel66111;
    private javax.swing.JLabel jLabel652111;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JTextField jTextField20;
    private org.netbeans.lib.sql.NBCachedRowSet crset5;
    private javax.swing.JTextField jTextField33;
    private javax.swing.JButton jButton211;
    private javax.swing.JLabel jLabel572111;
    private javax.swing.JTextField jTextField12;
    private javax.swing.JSeparator jSeparator12;
    private javax.swing.JSeparator jSeparator5;
    private org.netbeans.lib.sql.NBCachedRowSet crset13;
    private javax.swing.JLabel jLabel1541;
    private javax.swing.JTextField jTextField53;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JTextField jTextField8;
    private org.netbeans.lib.sql.NBCachedRowSet crset4;
    private javax.swing.JLabel jLabel59231;
    private javax.swing.JButton jButton411;
    private org.netbeans.lib.sql.NBCachedRowSet crset12;
    private javax.swing.JDialog jDialog1;
    private javax.swing.JList jList1;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JTextField jTextField13;
    private javax.swing.JTextField jTextField10;
    private javax.swing.JLabel jLabel63221;
    private javax.swing.JTextField jTextField29;
    private javax.swing.JLabel jLabel592221;
    private javax.swing.JLabel jLabel632111;
    private javax.swing.JPanel jPanel1;
    private org.netbeans.lib.sql.NBCachedRowSet crset7;
    private javax.swing.JTextField jTextField28;
    private javax.swing.JLabel jLabel642111;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JComboBox jComboBox1;
    private javax.swing.JSeparator jSeparator71221;
    private javax.swing.JTextField jTextField54;
    private javax.swing.JList jList2;
    private org.netbeans.lib.sql.pool.PooledConnectionSource pconn1;
    private javax.swing.JTextField jTextField14;
    private javax.swing.JTabbedPane jTabbedPane1;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JTable jTable2;
    private javax.swing.JTextField jTextField9;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JButton jButton42;
    private javax.swing.JTextField jTextField17;
    private javax.swing.JSeparator jSeparator111;
    private javax.swing.JTextField jTextField18;
    private javax.swing.JLabel jLabel622221;
    private javax.swing.JLabel jLabel64231;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel52111;
    private javax.swing.JLabel jLabel60221;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JPanel jPanel52221;
    private javax.swing.JPanel jPanel5231;
    private javax.swing.JTextField jTextField16;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JButton jButton22;
    private javax.swing.JTextField jTextField4;
    private javax.swing.JTable jTable1;
    // End of variables declaration//GEN-END:variables
    
}
